# Запуск PowerShell с правами администратора
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Host "Пожалуйста, запустите этот скрипт от имени администратора." -ForegroundColor Red
    exit
}

# Удаление компонентов Windows Defender
try {
    # Удаляем службу Windows Defender
    Stop-Service -Name WinDefend -Force
    Set-Service -Name WinDefend -StartupType Disabled
    Write-Host "Служба Windows Defender отключена." -ForegroundColor Green

    # Удаление папок и файлов Windows Defender
    Remove-Item -Path "C:\ProgramData\Microsoft\Windows Defender" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item -Path "C:\Program Files\Windows Defender" -Recurse -Force -ErrorAction SilentlyContinue
    Write-Host "Файлы Windows Defender удалены." -ForegroundColor Green
} catch {
    Write-Host "Ошибка при удалении файлов или отключении службы Windows Defender: $_" -ForegroundColor Red
}
