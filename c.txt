# Function to list installed antivirus software
function Get-AntivirusSoftware {
    $antivirusProducts = Get-CimInstance -Namespace root\SecurityCenter2 -ClassName AntivirusProduct
    if ($antivirusProducts) {
        Write-Host "Installed Antivirus Software:" -ForegroundColor Green
        foreach ($product in $antivirusProducts) {
            Write-Host "Product Name: $($product.displayName)" -ForegroundColor Cyan
            Write-Host "Product State: $($product.productState)" -ForegroundColor Yellow
            Write-Host "-----------------------------------"
        }
    } else {
        Write-Host "No antivirus software detected." -ForegroundColor Red
    }
}

# Main script
Write-Host "Checking for installed antivirus software..."
Get-AntivirusSoftware

Write-Host "`nPlease ensure all antivirus software is disabled before proceeding."
$response = Read-Host "Type 'y' to continue with the installation process"

if ($response -eq 'y') {
    Write-Host "`nStarting installation process. Do not close this window..." -ForegroundColor Green
    
    # Simulate file download and execution
    Write-Host "Downloading and installing file 1..."
    Start-Sleep -Seconds 3  # Simulating download time
    Write-Host "File 1 installed successfully."

    Write-Host "Downloading and installing file 2..."
    Start-Sleep -Seconds 3  # Simulating download time
    Write-Host "File 2 installed successfully."

    Write-Host "`nInstallation complete. You may now close this window." -ForegroundColor Green
} else {
    Write-Host "`nInstallation aborted. Please disable antivirus software and try again." -ForegroundColor Red
}
